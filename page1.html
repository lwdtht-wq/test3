<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Future Religious Trends Â· Cyber Faith</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="style.css">
<script src="https://d3js.org/d3.v7.min.js"></script>
<script defer src="main.js"></script>

<style>
/* ------- Extra Cyberpunk Chart Styles ------- */
.chart-tooltip {
  position: absolute;
  padding: 10px 14px;
  background: rgba(10,20,30,0.8);
  backdrop-filter: blur(6px);
  border: 1px solid #4af1ff;
  border-radius: 8px;
  color: #dff6ff;
  pointer-events: none;
  font-size: 13px;
  display: none;
}

.legend-btn {
  padding: 6px 12px;
  background: rgba(10,20,30,0.6);
  border: 1px solid #4af1ff88;
  color: #9bddff;
  border-radius: 6px;
  cursor: pointer;
  margin-right: 10px;
  transition: 0.2s;
}

.legend-btn:hover {
  box-shadow: 0 0 10px #4af1ff;
}
.legend-btn.active {
  background: #4af1ff22;
  box-shadow: 0 0 12px #4af1ff;
}
</style>

</head>
<body>

<!-- ======================= PAGE OPENING ======================= -->
<div class="page-opening">
    <img src="assets/open1.jpg">
    <div class="page-title-overlay glitch" data-text="FUTURE RELIGION TRENDS">
        FUTURE RELIGION TRENDS
    </div>
</div>

<!-- ======================= NAV ======================= -->
<nav id="sideNav" class="hidden">
    <a href="index.html" class="nav-icon" data-label="Home">ğŸœ‚</a>
    <a href="page1.html" class="nav-icon" data-label="Trends">ğŸœ</a>
    <a href="page2.html" class="nav-icon" data-label="New Faiths">âŸŸ</a>
    <a href="page3.html" class="nav-icon" data-label="World Map">ğŸœ„</a>
    <a href="page4.html" class="nav-icon" data-label="Liquid Metal">âŸ</a>
    <a href="page5.html" class="nav-icon" data-label="Story">â››</a>
</nav>

<!-- ======================= CONTENT ======================= -->
<section class="page-panel">

<h2>Projected Growth of Religious Groups (2010â€“2150)</h2>

<p>
This chart combines partial real-world data with speculative future projections.
It shows traditional religions declining while techno-faith rises.
</p>

<!-- Legend -->
<div style="margin-bottom:20px;">
  <button class="legend-btn active" data-key="traditional">Traditional</button>
  <button class="legend-btn active" data-key="tech">Techno-Faith</button>
  <button class="legend-btn active" data-key="none">Unaffiliated</button>
</div>

<div id="chart" style="width:100%;height:460px;margin-top:20px;"></div>

</section>

<!-- ======================= D3 SCRIPT ======================= -->
<script>
const data = [
  { year: 2010, traditional: 83, tech: 0, none: 17 },
  { year: 2020, traditional: 78, tech: 0, none: 22 },
  { year: 2030, traditional: 60, tech: 5, none: 35 },
  { year: 2040, traditional: 48, tech: 18, none: 34 },
  { year: 2050, traditional: 35, tech: 32, none: 33 },
  { year: 2075, traditional: 20, tech: 55, none: 25 },
  { year: 2100, traditional: 12, tech: 68, none: 20 },
  { year: 2150, traditional: 5,  tech: 82, none: 13 }
];

const w = 900, h = 420;
const margin = { top: 40, right: 80, bottom: 40, left: 70 };

const svg = d3.select("#chart")
  .append("svg")
  .attr("width", w)
  .attr("height", h);

const x = d3.scaleLinear()
  .domain(d3.extent(data, d => d.year))
  .range([margin.left, w - margin.right]);

const y = d3.scaleLinear()
  .domain([0, 100])
  .range([h - margin.bottom, margin.top]);

svg.append("g")
  .attr("transform", `translate(0, ${h - margin.bottom})`)
  .call(d3.axisBottom(x).ticks(7).tickFormat(d3.format("d")))
  .attr("color", "#7bc4ff");

svg.append("g")
  .attr("transform", `translate(${margin.left}, 0)`)
  .call(d3.axisLeft(y))
  .attr("color", "#7bc4ff");

const colors = {
  traditional: "#ff3df2",
  tech: "#4af1ff",
  none: "#8cc7ff"
};

/* ---------------- DRAW LINES WITH ANIMATION ---------------- */
function drawLine(key) {
  const line = d3.line()
    .x(d => x(d.year))
    .y(d => y(d[key]));

  // Path
  const p = svg.append("path")
    .datum(data)
    .attr("fill", "none")
    .attr("stroke", colors[key])
    .attr("stroke-width", 3)
    .attr("opacity", 0.9)
    .attr("d", line)
    .style("filter", "drop-shadow(0px 0px 6px " + colors[key] + ")");

  // Animate drawing
  const length = p.node().getTotalLength();
  p.attr("stroke-dasharray", length)
   .attr("stroke-dashoffset", length)
   .transition()
   .duration(2000)
   .ease(d3.easeCubic)
   .attr("stroke-dashoffset", 0);

  return p;
}

let paths = {
  traditional: drawLine("traditional"),
  tech: drawLine("tech"),
  none: drawLine("none")
};

/* ---------------- Hover Interaction: vertical line + glowing point ---------------- */
const tooltip = document.querySelector(".chart-tooltip");
const hoverLine = svg.append("line")
  .attr("stroke", "#4af1ff88")
  .attr("stroke-width", 2)
  .attr("y1", margin.top)
  .attr("y2", h - margin.bottom)
  .style("display", "none");

svg.on("mousemove", function (event) {
  const [mx] = d3.pointer(event);
  const year = Math.round(x.invert(mx));
  const d = data.find(v => v.year === year);
  if (!d) return;

  hoverLine.attr("x1", x(year)).attr("x2", x(year)).style("display", "block");

  tooltip.style.display = "block";
  tooltip.style.left = event.pageX + "px";
  tooltip.style.top = event.pageY - 30 + "px";

  tooltip.innerHTML =
    `<strong>${year}</strong><br>
     Traditional: ${d.traditional}%<br>
     Techno-Faith: ${d.tech}%<br>
     None: ${d.none}%`;
});

svg.on("mouseleave", () => {
  hoverLine.style("display", "none");
  tooltip.style.display = "none";
});

/* ---------------- Legend toggle ---------------- */
document.querySelectorAll(".legend-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    const key = btn.dataset.key;

    if (btn.classList.contains("active")) {
      btn.classList.remove("active");
      paths[key].style("display", "none");
    } else {
      btn.classList.add("active");
      paths[key].style("display", "block");
    }
  });
});
</script>

</body>
</html>
